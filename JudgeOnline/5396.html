<html><head><meta charset="utf-8"/><link rel="icon" href="../image/logo32x32.png" sizes="32x32" /><link rel="icon" href="../image/logo192x192.png" sizes="192x192" /><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>[Ynoi2016]炸脖龙II</title></head><body><div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/logo.png"><span style="font-family: Lato,'Helvetica Neue',Arial,Helvetica,sans-serif; font-size: 1.3em; font-weight: 300; ">BZPRO</span></a></div><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">#5396. [Ynoi2016]炸脖龙II</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MiB</span> <span class="ui label">时间限制：10 Sec</span></div></div><div class="ui grid"><div class="row"><div class="column"><div class="ui buttons"><a class="small ui primary button" href="https://www.lydsy.com/JudgeOnline/submitpage.php?id=5396">提交</a> <a class="small ui positive button" href="https://www.lydsy.com/JudgeOnline/problemstatus.php?id=5396">提交记录</a> <a class="small ui yellow button" href="https://www.lydsy.com/JudgeOnline/wttl/wttl.php?pid=5396">讨论</a></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div>瞬间&hellip;</div>
<div>真要说的话，比瞬间还要短暂。</div>
<div>羽咲往悬崖的方向飞去。</div>
<div>瘦小的羽咲，比想象中更轻易地飞下了悬崖。</div>
<div>我急忙跑向悬崖边。</div>
<div>然而，飞奔而出之后，方向并不是那么容易改变。</div>
<div>我失去了平衡，就这么摔倒在地。</div>
<div>只能一直用目光追寻着羽咲的身影。</div>
<div>飞出悬崖的羽咲。</div>
<div>身体浮在半空中。</div>
<div>在下一瞬间，便听任自由落体定律&hellip;径直坠下陡峭的悬崖</div>
<div>&nbsp;<img src="upload/201806/1(2).png" width="558" height="419" alt="" /></div>
<div>细长的双眼&hellip;注视着我的眼睛。</div>
<div>这是幻觉吗&hellip;还是现实&hellip;</div>
<div>卓司的指尖捅破了头盖骨&hellip;</div>
<div>这根本不可能的吧&hellip;人的手劲如何能够捏破头盖骨&hellip;</div>
<div>这毫无疑问是幻觉&hellip;不可能存在于现实中&hellip;</div>
<div>这种事，习武的我是最清楚不过的&hellip;</div>
<div>这种根本不可能的事&hellip;</div>
<div>尽管如此&hellip;</div>
<div>我的意识仍朦胧起来&hellip;</div>
<div>已经无法与这个世界保持联系了&hellip;</div>
<div>&quot;我&hellip;收下皆守哥哥的身体了哦&hellip;&quot;</div>
<div>&nbsp;<img src="upload/201806/2(3).png" width="558" height="419" alt="" /></div>
<div>司空见惯的风景。</div>
<div>比之前看到的风景更让人眼熟。</div>
<div>我所熟悉的风景&hellip;</div>
<div>&nbsp;<img src="upload/201806/3(2).png" width="558" height="419" alt="" /></div>
<div>&quot;我会把他带走的&hellip;所以你走吧&hellip;&quot;</div>
<div>&quot;卓司&hellip;那个电波小子，就让我把他带走&hellip;&quot;</div>
<div>&quot;所以你就前进吧&hellip;&quot;</div>
<div>&quot;在无法登上的坡道的尽头&quot;</div>
<div>&quot;你不能停滞不前，必须前去迎接小羽&quot;</div>
<div>&quot;好啦，打起精神来&hellip;皆守&quot;</div>
<div>&quot;在这里告别吧&hellip;&quot;</div>
<div>&nbsp;<img src="upload/201806/4(2).png" width="558" height="419" alt="" /></div>
<div>轻飘飘的感觉。</div>
<div>瞬间，感觉到了周围空气的急速变冷。</div>
<div>扬起的灰尘伴随月光的照耀，在空中飞舞。</div>
<div>告别了永不相交的平行，我和羽咲被吸进了&hellip;</div>
<div>垂直下落的世界。</div>
<div>月光映照出羽咲身体的轮廓。</div>
<div>地面没有影子。</div>
<div>宛如高空飞翔一般&hellip;</div>
<div>远方传来警笛声。</div>
<div>在苍穹之下反复回响。</div>
<div>我仰望无限的天空，笔直坠下。</div>
<div>一刻也不愿看丢，在我上方的羽咲&hellip;</div>
<div>月在笑。</div>
<div>神在笑。</div>
<div>笑这滑稽的姿势。</div>
<div>笑这喜剧般的悲剧。</div>
<div>群星旋转。</div>
<div>如舞如蹈。</div>
<div>夜空上的神，正嘲弄着我们。</div>
<div>就像把空瓶子扔在地上的天真的孩子一样&hellip;</div>
<div>世界变得一片空虚。</div>
<div>&nbsp;<img src="upload/201806/5(2).png" width="558" height="419" alt="" /></div>
<div>望不到尽头的坡道&hellip;</div>
<div>遥远而模糊的坡道&hellip;</div>
<div>宛如&hellip;我们就漫步在这样的世界中一般&hellip;</div>
<div>就算在意坡道的前方也毫无用处。</div>
<div>我们就在这坡道上快乐地走着。</div>
<div>&nbsp;<img src="upload/201806/6(1).png" width="558" height="419" alt="" /></div>
<div>您在打galgame，突然听说苏联解体了，于是您发现您永远看不到一个活着的苏联人了，很郁闷，于是开始写一道数据结构题：</div>
<div>这是一道模(du)拟(liu)题。 &nbsp;</div>
<div>你需要维护一棵包含n个结点有根有序树（也就是说每个点的孩子是有&quot;从左到右&quot;的顺序的），初始根为1，支持以下几个操作： &nbsp;</div>
<div>A(x,y):对x进行路径压缩，即将x到根路径上除了根之外的点的父亲设为根，这些点在根的孩子中的顺序保持原先路径上从浅到深的顺序 &nbsp;</div>
<div>B(x,y):将根的孩子x,y（x在y左边）以及之间的点按顺序展开成一条路径，x仍与根相连，涉及到的点原先的孩子都移至路径右侧 &nbsp;</div>
<div>C(x,y):将树的根设为x，此时原先在根到x路径左侧的点仍在左侧且先相对顺序不变，右侧同理，x的孩子在x成为根后在x到原先的根的路径的右侧 &nbsp;</div>
<div>D(x,y):给x到根的路径上每个点的点权同时加一个数，并在这之后求x到根的路径上的点权和 &nbsp;</div>
<div>E(x,y):保证x和y父亲相同且x在y左侧，对在x的父亲的孩子中，x到y之间（含x,y）的每个点的点权加上x+y，并在这之后求这些点的点权和 &nbsp;</div>
<div>F(x,y):给x添加一个孩子y，在最右边，这个操作在其它所有操作之前进行，用于描述树的初始形态 &nbsp;</div>
<p></p></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div class=content><div>第一行两个整数n,q，分别表示树的结点数和操作次数， &nbsp;</div>
<div>接下来q行，每行表示一个操作。 &nbsp;</div>
<p></p></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div class=content><div>对每个D或E操作，输出一行，表示答案对2^32取模的结果。&nbsp;</div>
<p></p></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">
			<div class=content><span class=sampledata>20 30<br />
F(1,2)<br />
F(1,3)<br />
F(1,7)<br />
F(1,9)<br />
F(9,5)<br />
F(3,8)<br />
F(3,20)<br />
F(3,6)<br />
F(8,15)<br />
F(8,19)<br />
F(20,14)<br />
F(20,12)<br />
F(6,13)<br />
F(6,18)<br />
F(13,4)<br />
F(12,11)<br />
F(12,17)<br />
F(17,10)<br />
F(17,16)<br />
E(3,9)<br />
E(8,6)<br />
A(12,0)<br />
D(4,6)<br />
E(2,7)<br />
B(3,12)<br />
D(4,6)<br />
C(8,0)<br />
D(13,5)<br />
D(1,7)<br />
E(12,14)</span></div></code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">
			<div class=content><span class=sampledata>36<br />
42<br />
56<br />
89<br />
95<br />
105<br />
90<br />
61</span></div></code></pre></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">
			<div class=content><p><div>2&lt;= n&lt;= 100000</div><br />
<div>n&lt;= q&lt;= 200000 &nbsp;</div><br />
<div>0&lt;= x,y &lt;= n &nbsp;</div><br />
<div>保证操作合法。</div><br />
<div>为了对称，所有操作都有两个参数x,y，但实际上A,C操作中不需用到y，数据保证此时y=0。 &nbsp;</div><br />
<div>前n-1个操作一定是F操作，保证n-1次操作后得到一棵以1为根的树，且以后不会再出现F操作。 &nbsp;</div><br />
<div>注意到A,B,C,F操作都有关于孩子顺序的规定，可以参照样例解释进行直观的理解。 &nbsp;</div><br />
<div>共10组数据</div><br />
<p></p></p></div></div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">BZPRO Powered by Remmina.</span><br/><a href="https://github.com/remmina/BZPRO">Github Repository</a></div></div></body></html>